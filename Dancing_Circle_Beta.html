<!DOCTYPE html>
<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <!--this doesn't seem to help-->
    <meta http-equiv="Access-Control-Allow-Origin" content="*"/>
<style>
body {
  margin: 5px;
}
button {
  position: absolute;
  right: 30px;
  top: 30px;
}
</style>
<button>Reset</button>
<body>
<script src="https://d3js.org/d3.v3.js"></script>
<script>


var margin = {top: 0, right: 0, bottom: 0, left: 0},
    width = 700,    // canvas width
    height = 900;   // canvas height

var scale = 2.0;

var zoom = d3.behavior.zoom()
    .scale(scale)
    .scaleExtent([1, 8])
    .on("zoom", zoomed);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
    .attr("style", "outline: medium solid red;")
    .call(zoom);

var container = svg.append("g")
    .attr("id", "container")
    .attr("transform", "translate(0,0)scale(1,1)");

var bbox, viewBox, vx, vy, vw, vh, defaultView;

var clickScale = 2.0;   // scale used when circle is clicked

d3.select("button").on("click", reset);
d3.json("https://raw.githubusercontent.com/aishwarya-shrinivas/wpi/master/shapes.json", function(obj) {


console.log(obj.Circles);

  circle = container.append("g")
    .attr("id", "circle")
    .selectAll
  ("circle")
      .data(obj.Circles)
    .enter().append("circle")
      .attr("r",  function(d) {return d.radius; })
      .attr("cx", function(d) { return d.cx; })
      .attr("cy", function(d) { return d.cy; })
      .style("fill", function(d) { return d.fill; })
      .on("click", clicked);
    
    
    // wait 2 seconds, then slowly change the circle's properties
  /*.transition()
  .duration(3000)
  .delay(2000)
  .attr("cx",600)
  .attr("cy",150)
  .style("fill","orange")
  .attr("r",50);*/
  
      
      
circle  // click the circle to set it properties at random
  .on("click",function(){
    d3.select(this)
      .transition()
      .duration(3000)
      .attr("cx",Math.random()*700)
      .attr("cy",Math.random()*300)
      .style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      .attr("r",Math.random()*100)
.style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      .attr("r",Math.random()*100);
  });
  
    
   circle1 = container.append("g")
    .attr("id", "circles")
    .selectAll
  ("circle1")
      .data(obj.Circles)
    .enter().append("circle1")
      .attr("r",  function(d) {return d.radius; })
      .attr("cx", function(d) { return d.cx; })
      .attr("cy", function(d) { return d.cy; })
      .style("fill", function(d) { return d.fill; })
      .on("click", clicked);

      circle  // click the circle to set it properties at random
  .on("click",function(){
    d3.select(this)
      .transition()
      .duration(3000)
      .attr("cx",Math.random()*700)
      .attr("cy",Math.random()*300)
      .style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      .attr("r",Math.random()*100)
.style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      .attr("r",Math.random()*100);
  });
    
    
    circle2 = container.append("g")
    .attr("id", "circles")
    .selectAll
  ("circle2")
      .data(obj.Circles)
    .enter().append("circle2")
      .attr("r",  function(d) {return d.radius; })
      .attr("cx", function(d) { return d.cx; })
      .attr("cy", function(d) { return d.cy; })
      .style("fill", function(d) { return d.fill; })
      .on("click", clicked);

      circle  // click the circle to set it properties at random
  .on("click",function(){
    d3.select(this)
      .transition()
      .duration(3000)
      .attr("cx",Math.random()*700)
      .attr("cy",Math.random()*300)
      .style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      .attr("r",Math.random()*100)
.style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      .attr("r",Math.random()*100);
  });
    
    
    
    
  rect = container.append("g")
    .attr("id", "rect")
    .selectAll
  ("rect")
      .data(obj.Rectangle)
    .enter().append("rect")
      .attr("x",  function(d) {return d.x; })
      .attr("y", function(d) { return d.y; })
      .attr("height", function(d) { return d.height; })
    .attr("width", function(d) { return d.width; })
      .style("fill", function(d) { return d.fill; })
      .on("click", clicked);
    
     /*rect  // wait 2 seconds, then slowly change the circle's properties
  .transition()
  .duration(3000)
  .delay(2000)
  .attr("x",150)
  .attr("y",-1000)
  .attr("height", 500)
  .attr("width", 700)
  .style("fill","orange")*/


rect  // click the circle to set it properties at random
  .on("click",function(){
    d3.select(this)
      .transition()
      .duration(3000)
      .attr("x",Math.random()*700)
      .attr("y",Math.random()*300)
      .attr("height",Math.random()*700)
      .attr("width",Math.random()*300)
      .style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      
  });
    
   /* rect1 = container.append("g")
    .attr("id", "rect1")
    .selectAll
  ("rect1")
      .data(obj.Rectangle)
    .enter().append("rect1")
      .attr("x",  function(d) {return d.x; })
      .attr("y", function(d) { return d.y; })
      .attr("height", function(d) { return d.height; })
    .attr("width", function(d) { return d.width; })
      .style("fill", function(d) { return d.fill; })
      .on("click", clicked);
    
    rect2 = container.append("g")
    .attr("id", "rect2")
    .selectAll
  ("rect2")
      .data(obj.Rectangle)
    .enter().append("rect2")
      .attr("x",  function(d) {return d.x; })
      .attr("y", function(d) { return d.y; })
      .attr("height", function(d) { return d.height; })
    .attr("width", function(d) { return d.width; })
      .style("fill", function(d) { return d.fill; })
      .on("click", clicked);*/
    
    
    line = container.append("g")
    .attr("id", "line")
    .selectAll
  ("line")
      .data(obj.Lines)
    .enter().append("line")
      .attr("x1",  function(d) {return d.x1; })
      .attr("y1", function(d) { return d.y1; })
      .attr("x2", function(d) { return d.x2; })
    .attr("y2", function(d) { return d.y2; })
      .style("stroke", function(d) { return d.stroke; })
    .style("stroke-width", function(d) { return d.stroke-width; })
      .on("click", clicked);
    
    line  // click the circle to set it properties at random
  .on("click",function(){
    d3.select(this)
      .transition()
      .duration(3000)
      .attr("x1",Math.random()*700)
      .attr("y1",Math.random()*300)
      .attr("x2",Math.random()*700)
      .attr("y2",Math.random()*300)
      
      .style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      
      
  });
  
    
    
    
  /*  line1 = container.append("g")
    .attr("id", "line1")
    .selectAll
  ("line1")
      .data(obj.Lines)
    .enter().append("line1")
      .attr("x1",  function(d) {return d.x1; })
      .attr("y1", function(d) { return d.y1; })
      .attr("x2", function(d) { return d.x2; })
    .attr("y2", function(d) { return d.y2; })
      .style("stroke", function(d) { return d.stroke; })
    .style("stroke-width", function(d) { return d.stroke-width; })
      .on("click", clicked);
    
    line2 = container.append("g")
    .attr("id", "line2")
    .selectAll
  ("line2")
      .data(obj.Lines)
    .enter().append("line2")
      .attr("x1",  function(d) {return d.x1; })
      .attr("y1", function(d) { return d.y1; })
      .attr("x2", function(d) { return d.x2; })
    .attr("y2", function(d) { return d.y2; })
      .style("stroke", function(d) { return d.stroke; })
    .style("stroke-width", function(d) { return d.stroke-width; })
      .on("click", clicked);*/
    
    
    
    
    
    var scaleX = d3.scale.linear()
        .domain([-500,10]) //Give appropriate range in the scale
        .range([0,width]);

var scaleY = d3.scale.linear()
        .domain([-500,0]) //Give appropriate range in the scale
        .range([height,0]);

    

    
    
    polygon2 = container.append("g")
    .attr("id", "polygon")
    .selectAll("polygon")
    .data(obj.Polygons)
    .enter().append("polygon")
    .attr("points",function(d) { 
          return d.points.map(function(d) {return [scaleX(d.x),scaleY(d.y)].join(","); }).join(" ");})
      .attr("fill","pink")
    .on("click", clicked);
       // wait 2 seconds, then slowly change the circle's properties
     line  // click the circle to set it properties at random
  .on("click",function(){
    d3.select(this)
      .transition()
      .duration(3000)
      .attr("x",Math.random()*700)
      .attr("y",Math.random()*300)
      .attr("x",Math.random()*700)
      .attr("y",Math.random()*300)
      .attr("x",Math.random()*700)
      .attr("y",Math.random()*300)
      .style("fill",d3.rgb( Math.random()*255,Math.random()*255,Math.random()*255 ))
      
      
  });
     
  
  
    
    
   
    
   
bbox = container.node().getBBox();
  vx = bbox.x;    // container x co-ordinate
  vy = bbox.y;    // container y co-ordinate
  vw = bbox.width;  // container width
  vh = bbox.height; // container height
  defaultView = "" + vx + " " + vy + " " + vw + " " + vh;
  svg
  .attr("viewBox", defaultView)
  .attr("preserveAspectRatio", "xMidYMid meet")
        .call(zoom);
});

/*
getTransform(node, scale) finds the correct translation co-ordinates in order
to center the circle (node) into the Viewbox. This depends on the scale.
 - bbox is the bounding box of the circle (node)
 - vx is the top-left x-cordinate of the Viewbox
 - vy is the top-left y-cordinate of the Viewbox
 - tx is the calculated movement in the x co-ordinate 
 - ty is the calculated movement in the y co-ordinate 
 - xScale is the scale of the SVG with respect to the default Viewbox
*/
function getTransform(node, xScale) {
  bbox = node.node().getBBox();
  var bx = bbox.x;
  var by = bbox.y;
  var bw = bbox.width;
  var bh = bbox.height;
  var tx = -bx*xScale + vx + vw/2 - bw*xScale/2;
  var ty = -by*xScale + vy + vh/2 - bh*xScale/2;
  return {translate: [tx, ty], scale: xScale}
}

function clicked(d, i) {
  if (d3.event.defaultPrevented) {
  return; // panning, not clicking
  }
  node = d3.select(this);
  var transform = getTransform(node, clickScale);
  container.transition().duration(1000)
     .attr("transform", "translate(" + transform.translate + ")scale(" + transform.scale + ")");
  zoom.scale(transform.scale)
      .translate(transform.translate);
  scale = transform.scale;
}

function circletype(d) {
  d.x = +d.x;
  d.y = +d.y;
  d.r = +d.r;
  return d;
}

function zoomed() {
  var translateX = d3.event.translate[0];
  var translateY = d3.event.translate[1];
  var xScale = d3.event.scale;
  container.attr("transform", "translate(" + translateX + "," + translateY + ")scale(" + xScale + ")");
}

function reset() {
  scale = 1.0;
  container.attr("transform", "translate(0,0)scale(1,1)");
  zoom.scale(scale)
      .translate([0,0]);
}

d3.select(self.frameElement).attr("margin", 10);
</script>
